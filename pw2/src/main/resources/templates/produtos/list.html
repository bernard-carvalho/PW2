<div th:insert="fragments/header :: modelheader"></div>

<style>
    *{text-align: center;} .hidden{display:none;}
</style>
<script>
    function excluir(botao){
        let xhr = new XMLHttpRequest();
        let url = "/produtos/"+botao.parentNode.parentNode.querySelectorAll("input")[0].value;
        xhr.open("DELETE",url,true);
        xhr.onload=function(){
            location.href=location.href;
        }
        xhr.send();
    }
</script>
<table>
    <tr>
        <th><p class="hidden">Id</p></th>
        <th>Nome</th>
        <th>Preço</th>
        <th>Ações</th>
    </tr>
    <tr th:each="produto : ${produtos}">
        <form>
            <td><input type="number" th:value="${produto.id}" name="id" class="hidden"></td>
            <td><input type="text" th:value="${produto.nome}" name="nome"></td>
            <td><input type="number" step="0.01" th:value="${produto.preco}" name="preco"></td>
            <td><button>ALTERAR</button><button onclick="excluir(this)">EXCLUIR</button></td>
        </form>
    </tr>
    <tr>
        <form action="/produtos" method="POST" th:object="${Produto}">
            <td></td>
            <td><input type="text" id="nome" name="nome" placeholder="Nome"></td>
            <td><input type="number" id="preco" step="0.01" name="preco" placeholder="Preco"></td>
            <td><input type="submit" value="Enviar" ></td>
        </form>
    </tr>
</table>

<div th:insert="fragments/footer :: modelfooter"></div>